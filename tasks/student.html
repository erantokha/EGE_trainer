<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="app-build" content="2026-01-09-3">
  <title>Ученик</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="./trainer.css?v=2026-01-09-3">
  <link rel="stylesheet" href="./stats.css?v=2026-01-09-3">
</head>
<body>
  <main class="container">
    <section>
      <div class="panel">
        <header id="appHeader" class="page-head">
          <div>
            <h1 id="pageTitle">Ученик</h1>
            <div id="studentSub" class="muted" style="margin-top:6px;display:none"></div>
          </div>
        </header>

        <script type="module">
          const BUILD = document.querySelector('meta[name="app-build"]')?.content?.trim();
          const withV = (p) => BUILD ? `${p}${p.includes('?') ? '&' : '?'}v=${encodeURIComponent(BUILD)}` : p;
          const inTasks = /\/tasks(\/|$)/.test(location.pathname);
          const rel = inTasks ? '../' : './';
          import(withV(rel + 'app/ui/header.js')).then((m) => m.initHeader({ isHome: !inTasks }));
        </script>

        <div id="pageStatus" class="muted" style="min-height:20px"></div>

        <div style="margin-top:12px">
          <div style="font-size:18px; margin:10px 0 6px">Статистика</div>
          <div id="statsRoot"></div>
        </div>

        <div id="smartHwBlock" style="margin-top:14px; display:none">
          <hr style="border:none;border-top:1px solid var(--border);margin:14px 0">

          <div style="font-size:18px; margin:10px 0 6px">Умная домашка</div>

          <div class="stats-actions">
            <button id="smartHwToggle" class="btn" type="button">Собрать ДЗ по слабым местам</button>
          </div>

          <div id="smartHwPanel" class="hidden" style="margin-top:10px; border:1px solid var(--border); border-radius:14px; padding:12px; background: rgba(148,163,184,.05)">
            <div class="stats-controls">
              <div class="ctrl">
                <label>Период</label>
                <select id="smartHwDays">
                  <option value="7">7 дней</option>
                  <option value="14">14 дней</option>
                  <option value="30" selected>30 дней</option>
                  <option value="90">90 дней</option>
                </select>
              </div>

              <div class="ctrl">
                <label>Источник</label>
                <select id="smartHwSource">
                  <option value="all" selected>всё</option>
                  <option value="self">самостоятельно</option>
                  <option value="homework">ДЗ</option>
                </select>
              </div>

              <div class="ctrl">
                <label>Метрика</label>
                <select id="smartHwMetric">
                  <option value="period" selected>за период</option>
                  <option value="last10">последние 10</option>
                  <option value="all_time">всё время</option>
                </select>
              </div>

              <div class="ctrl">
                <label>Задач всего</label>
                <input id="smartHwTotal" type="number" min="1" max="50" value="12" style="width:120px">
              </div>

              <div class="ctrl">
                <label>Макс. тем</label>
                <input id="smartHwMaxTopics" type="number" min="1" max="20" value="5" style="width:120px">
              </div>

              <div class="ctrl">
                <label>Мин. попыток</label>
                <input id="smartHwMinTotal" type="number" min="0" max="50" value="3" style="width:120px">
              </div>

              <div class="ctrl" style="min-width:260px;flex:1">
                <label>Заголовок</label>
                <input id="smartHwTitle" type="text" placeholder="Умная ДЗ" style="width:100%">
              </div>

              <div class="ctrl" style="min-width:260px">
                <label style="display:flex; gap:8px; align-items:center">
                  <input id="smartHwPreferUncovered" type="checkbox">
                  Добрать непокрытые, если нет данных
                </label>
              </div>
            </div>

            <div class="stats-actions" style="margin-top:10px">
              <button id="smartHwCreate" class="btn" type="button">Создать</button>
              <button id="smartHwClose" class="btn" type="button">Скрыть</button>
              <span id="smartHwStatus" class="muted"></span>
            </div>

            <div id="smartHwPreview" class="muted" style="margin-top:8px"></div>

            <div id="smartHwResult" class="hidden" style="margin-top:12px">
              <div class="stats-controls">
                <div class="ctrl" style="flex:1">
                  <label>Ссылка для ученика</label>
                  <input id="smartHwLink" type="text" readonly style="width:100%">
                </div>
                <div class="stats-actions">
                  <button id="smartHwCopy" class="btn" type="button">Скопировать</button>
                  <button id="smartHwOpen" class="btn" type="button">Открыть</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <hr style="border:none;border-top:1px solid var(--border);margin:14px 0">

        <div>
          <div style="font-size:18px; margin:10px 0 6px">Выполненные работы</div>
          <div id="worksList" style="margin-top:10px"></div>
        </div>

        <div style="margin-top:16px">
          <button id="backBtn" class="btn" type="button">Назад к списку</button>
        </div>
      </div>
    </section>
  </main>

  <script src="./theme.js?v=2026-01-09-3" defer></script>
  <script type="module">
    const BUILD = document.querySelector('meta[name="app-build"]')?.content?.trim();
    const withV = (p) => BUILD ? `${p}${p.includes('?') ? '&' : '?'}v=${encodeURIComponent(BUILD)}` : p;
    import(withV('./student.js'));
  </script>
</body>
</html>
