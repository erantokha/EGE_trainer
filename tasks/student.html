<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="app-build" content="2026-01-28-6">
  <title>Ученик</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="./trainer.css?v=2026-01-28-6">
  <link rel="stylesheet" href="./stats.css?v=2026-01-28-6">
</head>
<body>
  <main class="container">
    <section>
      <div class="panel">
        <header id="appHeader" class="page-head">
          <div>
            <div class="student-page-titlebar">
              <h1 id="pageTitle">Ученик</h1>

              <div id="studentActions" class="student-menu-wrap" style="display:none">
                <button id="studentGearBtn" class="btn student-gear-btn" type="button" aria-label="Действия" aria-expanded="false">⚙</button>
                <div id="studentGearMenu" class="student-menu hidden">
                  <button id="studentDeleteBtn" class="student-menu-item" type="button">Удалить</button>
                </div>
              </div>
            </div>

            <div id="studentSub" class="muted" style="margin-top:6px;display:none"></div>
          </div>
        </header>

        <script type="module">
          const BUILD = document.querySelector('meta[name="app-build"]')?.content?.trim();
          const withV = (p) => BUILD ? `${p}${p.includes('?') ? '&' : '?'}v=${encodeURIComponent(BUILD)}` : p;
          const inTasks = /\/tasks(\/|$)/.test(location.pathname);
          const rel = inTasks ? '../' : './';
          import(withV(rel + 'app/ui/header.js')).then((m) => m.initHeader({ isHome: !inTasks }));
        </script>

        <div id="pageStatus" class="muted" style="min-height:20px"></div>

        <div id="smartHwBlock" style="margin-top:14px; display:none">
          <hr style="border:none;border-top:1px solid var(--border);margin:14px 0">

          <div id="smartHwHead" class="smart-hw-head">
            <div style="font-size:18px">Умное ДЗ</div>
            <div class="stats-actions">
              <span id="smartHwChev" class="smart-hw-chev" aria-hidden="true">▾</span>
            </div>
          </div>

          <div id="smartHwPanel" class="hidden smart-hw-panel">
            <div class="stats-controls smart-hw-controls">
              <div class="ctrl">
                <label>Период</label>
                <select id="smartRecDays">
                  <option value="7">7 дней</option>
                  <option value="14">14 дней</option>
                  <option value="30" selected>30 дней</option>
                  <option value="90">90 дней</option>
                </select>
              </div>

              <div class="ctrl">
                <label>Источник</label>
                <select id="smartRecSource">
                  <option value="all" selected>всё</option>
                  <option value="self">самостоятельно</option>
                  <option value="homework">ДЗ</option>
                </select>
              </div>

              <div class="ctrl">
                <label>Рекомендации</label>
                <select id="smartRecMode">
                  <option value="mixed" selected>смешанный</option>
                  <option value="weak">слабые</option>
                  <option value="low">мало решено</option>
                  <option value="uncovered">не решал</option>
                </select>
              </div>

              <div class="ctrl">
                <label>Мин. попыток</label>
                <select id="smartRecMinAttempts">
                  <option value="1">1</option>
                  <option value="3" selected>3</option>
                  <option value="5">5</option>
                </select>
              </div>

              <div class="ctrl">
                <label>Лимит тем</label>
                <select id="smartRecLimit">
                  <option value="10">10</option>
                  <option value="15" selected>15</option>
                  <option value="25">25</option>
                </select>
              </div>

              <div class="ctrl">
                <label>По умолчанию</label>
                <select id="smartRecDefaultCount">
                  <option value="1">1 задача</option>
                  <option value="2" selected>2 задачи</option>
                  <option value="3">3 задачи</option>
                </select>
              </div>

              <div class="ctrl" style="min-width:260px;flex:1">
                <label>Название ДЗ</label>
                <input id="smartHwTitle" type="text" placeholder="Умное ДЗ" style="width:100%">
              </div>

              <div class="ctrl" style="min-width:260px">
                <label style="display:flex; gap:8px; align-items:center">
                  <input id="smartRecIncludeUncovered" type="checkbox" checked>
                  включать непокрытые
                </label>
              </div>
            </div>

            <div class="stats-actions" style="margin-top:10px">
              <button id="smartRecLoad" class="btn" type="button">Подобрать темы</button>
              <button id="smartRecAddAll" class="btn" type="button">Добавить все</button>
              <button id="smartRecAddTop5" class="btn" type="button">Топ-5</button>
              <button id="smartRecAddTop10" class="btn" type="button">Топ-10</button>
              <button id="smartPlanClear" class="btn" type="button">Очистить план</button>
              <button id="smartHwClose" class="btn" type="button">Скрыть</button>
              <span id="smartHwStatus" class="muted"></span>
            </div>

            <div class="smart-hw-grid" style="margin-top:12px">
              <div>
                <div class="smart-hw-subhead">Рекомендованные темы</div>
                <div class="smart-hw-toolbar">
                  <input id="smartRecSearch" class="smart-hw-search" type="text" placeholder="Поиск темы…">
                  <select id="smartRecSort" class="smart-hw-sort">
                    <option value="score" selected>по важности</option>
                    <option value="worst">хуже точность</option>
                    <option value="oldest">давно не решал</option>
                    <option value="few">мало попыток</option>
                    <option value="title">по названию</option>
                  </select>
                </div>
                <div id="smartRecList" class="smart-hw-list"></div>
              </div>

              <div>
                <div class="smart-hw-subhead">План ДЗ</div>
                <div id="smartPlanList" class="smart-hw-list"></div>

                <div class="smart-hw-total">
                  Тем: <span id="smartPlanTopics">0</span> · Всего задач: <span id="smartPlanTotal">0</span>
                </div>

                <div class="stats-actions" style="margin-top:10px; align-items:center">
                  <button id="smartHwCreate" class="btn" type="button" disabled>Создать ДЗ</button>
                  <span id="smartHwCreateHint" class="smart-hw-hint"></span>
                </div>

                <div id="smartHwResult" class="hidden" style="margin-top:12px">
                  <div class="stats-controls">
                    <div class="ctrl" style="flex:1">
                      <label>Ссылка для ученика</label>
                      <input id="smartHwLink" type="text" readonly style="width:100%">
                    </div>
                    <div class="stats-actions">
                      <button id="smartHwCopy" class="btn" type="button">Скопировать</button>
                      <button id="smartHwOpen" class="btn" type="button">Открыть</button>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>


        <div id="worksBlock" style="margin-top:14px">
          <hr style="border:none;border-top:1px solid var(--border);margin:14px 0">

          <div id="worksHead" class="smart-hw-head">
            <div style="font-size:18px">Выполненные работы</div>
            <div class="stats-actions">
              <span id="worksChev" class="smart-hw-chev" aria-hidden="true">▾</span>
            </div>
          </div>

          <div id="worksPanel" class="hidden" style="margin-top:10px">
            <div id="worksList" style="margin-top:10px"></div>
          </div>
        </div>

        <hr style="border:none;border-top:1px solid var(--border);margin:14px 0">

<div style="margin-top:12px">
          <div class="student-stat-head">
            <div class="student-stat-title">Статистика</div>
            <button id="statsFiltersToggle" class="icon-btn" type="button" aria-label="Фильтры" title="Фильтры">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M3 5h18l-7 8v5l-4 2v-7L3 5z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/></svg>
            </button>
          </div>
          <div id="statsRoot"></div>
        </div>

        <div style="margin-top:16px">
          <button id="backBtn" class="btn" type="button">Назад к списку</button>
        </div>
      </div>
    </section>
  </main>

  <script src="./theme.js?v=2026-01-28-6" defer></script>
  <script type="module">
    const BUILD = document.querySelector('meta[name="app-build"]')?.content?.trim();
    const withV = (p) => BUILD ? `${p}${p.includes('?') ? '&' : '?'}v=${encodeURIComponent(BUILD)}` : p;
    import(withV('./student.js'));
  </script>
</body>
</html>
